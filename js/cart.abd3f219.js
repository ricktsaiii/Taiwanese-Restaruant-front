(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cart"],{1876:function(e,t,r){},"6fe5":function(e,t,r){"use strict";r("1876")},a434:function(e,t,r){"use strict";var n=r("23e7"),a=r("da84"),i=r("23cb"),c=r("5926"),u=r("07fa"),o=r("7b0b"),s=r("65f0"),l=r("8418"),d=r("1dde"),p=d("splice"),f=a.TypeError,m=Math.max,h=Math.min,b=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!p},{splice:function(e,t){var r,n,a,d,p,k,g=o(this),w=u(g),x=i(e,w),y=arguments.length;if(0===y?r=n=0:1===y?(r=0,n=w-x):(r=y-2,n=h(m(c(t),0),w-x)),w+r-n>b)throw f(v);for(a=s(g,n),d=0;d<n;d++)p=x+d,p in g&&l(a,d,g[p]);if(a.length=n,r<n){for(d=x;d<w-n;d++)p=d+n,k=d+r,p in g?g[k]=g[p]:delete g[k];for(d=w;d>w-n+r;d--)delete g[d-1]}else if(r>n)for(d=w-n;d>x;d--)p=d+n-1,k=d+r-1,p in g?g[k]=g[p]:delete g[k];for(d=0;d<r;d++)g[d+x]=arguments[d+2];return g.length=w-n+r,a}})},b789:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"cart"}},[n("b-container",[n("div",{attrs:{id:"cart_logo"}},[n("img",{attrs:{src:r("cf05")}})]),n("b-table",{attrs:{id:"cart_table",items:e.products,fields:e.fields,"tbody-tr-class":e.rowClass},scopedSlots:e._u([{key:"cell(image)",fn:function(t){return[t.item.product.image?n("img",{staticStyle:{height:"50px"},attrs:{src:t.item.product.image}}):e._e()]}},{key:"cell(name)",fn:function(t){return[e._v(" "+e._s(t.item.product.name)+" ")]}},{key:"cell(price)",fn:function(t){return[e._v(" NT$"+e._s(t.item.product.price)+" ")]}},{key:"cell(action)",fn:function(t){return[n("b-form-spinbutton",{attrs:{min:"1",inline:""},on:{input:function(r){return e.updateCart(t.index,t.item.quantity)}},model:{value:t.item.quantity,callback:function(r){e.$set(t.item,"quantity",r)},expression:"data.item.quantity"}}),e._v("   "),n("b-btn",{attrs:{variant:"danger"},on:{click:function(r){return e.updateCart(t.index,0)}}},[e._v("x")])]}}])}),n("div",{attrs:{id:"checkout"}},[n("h2",[e._v("總金額 NT$"+e._s(e.total))]),n("b-btn",{attrs:{id:"check_btn"},on:{click:e.checkout}},[e._v("結 帳")])],1)],1)],1)},a=[],i=r("1da1"),c=(r("96cf"),r("a434"),r("d3b7"),{data:function(){return{products:[],fields:[{key:"image",label:"商品"},{key:"name",label:"名稱"},{key:"price",label:"價格"},{key:"action",label:"數量"}]}},methods:{updateCart:function(e,t){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.api.patch("/users/me/cart",{product:r.products[e].product._id,quantity:t},{headers:{authorization:"Bearer "+r.user.token}});case 3:0===t&&(r.products.splice(e,1),r.$store.commit("user/updateCart",r.user.cart-1)),n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](0),r.$swal({icon:"error",title:"失敗",text:"修改購物車失敗"});case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))()},checkout:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.api.post("/orders",{},{headers:{authorization:"Bearer "+e.user.token}});case 3:e.$router.push("/orders"),e.$store.commit("user/updateCart",0),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.$swal({icon:"error",title:"失敗",text:"結帳失敗"});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},rowClass:function(e,t){if(e&&"row"===t)return e.product.sell?"":"bg-danger"}},computed:{total:function(){return this.products.reduce((function(e,t){return e+t.quantity*t.product.price}),0)}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.api.get("/users/me/cart",{headers:{authorization:"Bearer "+e.user.token}});case 3:r=t.sent,n=r.data,e.products=n.result,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$swal({icon:"error",title:"失敗",text:"取得購物車失敗"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}),u=c,o=(r("6fe5"),r("2877")),s=Object(o["a"])(u,n,a,!1,null,null,null);t["default"]=s.exports}}]);
//# sourceMappingURL=cart.abd3f219.js.map